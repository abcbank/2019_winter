# 11. IIR FIilter Design
---
---
---
## 1. What is "IIR Filter Design"?
- ì•„ë‚ ë¡œê·¸ í•„í„°ì™€ ë™ì¼í•œ ê¸°ëŠ¥ì˜ IIR í•„í„°ë¥¼ ë§Œë“¤ë•Œ ì–´ë–¤ ê³¼ì •ì„ ê±°ì³ì•¼í•˜ëŠ”ê°€?
- General IIR Filter Equation: difference equation
    $y(n) = \Sigma_{k = 1} ^N a_k y(n - k) + \Sigma_{k = 0}^M b_k x(n - k)$
- í•´ë‹¹ ì‹ì„ ë””ì§€í„¸ë¡œ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„  $\left\{a_k\right\}_{k = 1}^N, \left\{b_k\right\}_{k = 1}^M$ì„ ì•Œì•„ì•¼ í•œë‹¤.
  - Impulse Invariance Method
  - Bilinear Tranform Method

## 2. Impulse Invariance Method

1. Take an analog filter 
2. Apply the Laplace Tranform to obtain H(s)
3. Apply inverse LT ot obtain h(t)
4. Sampling h(t) at a given sampling rate
5. Apply the z-transform to obtain H(z)
6. Apply inverse ZT to obtain the difference equation with x(n) and y(n)

### Example1: RC-lowpass filter

![curcit](./img/rc_lpf.png)

#### 1. Take an Analog Filter
- ì•„ë‚ ë¡œê·¸ íšŒë¡œì˜ ë°©ì •ì‹ì„ ì•Œì•„ë‚¸ë‹¤.
$x(t) = RC \frac {dy(t)}{dt} + y(t)$

#### 2. Get LT to obtain H(s)
- get LT
$\mathcal L \left\{x(t)\right\} = \mathcal L \left\{RC \frac {dy(t)}{dt} + y(t)\right\} = RC \mathcal L \left\{\frac {dy(t)}{dt}\right\} + \mathcal L \left\{y(t)\right\} = RC sY(s) + Y(s)$
- obtain H(s)
$H(s) = \frac{Y(s)}{X(s)} = \frac{1}{RCs + 1}$

#### 3. inverse LT
- inverse LT
$\mathcal L'\left\{H(s)\right\} = \mathcal L'\left\{\frac{1}{RCs + 1}\right\} = \frac{1}{RC}\mathcal L'\left\{\frac{1}{s + \frac{1}{RC}}\right\} = \frac{1}{RC}e^{-\frac{1}{RC}t}u(t)$

#### 4. Sampling
- sampling
$t = nt_s$
$h[n] = \frac{1}{RC}e^{-\frac{1}{RC}nt_s}u[n]$

#### 5. Get ZT to obtain a, b
- ZT
$H(z) = \frac{1}{RC} \frac{1}{1 - e^{\frac{1}{RC}t_s}z^{-1}}$
- obtain a, b
$H(z) = \frac{Y(z)}{X(z)} = \frac{1}{RC} \frac{1}{1 - e^{\frac{1}{RC}t_s}z^{-1}}$
$Y(z)(1 - e^{\frac{1}{RC}t_s}z^{-1}) = \frac{1}{RC}X(z)$

#### 6. inverse ZT
- inverse ZT
$\frac{1}{RC}x[n] = y[n] - e^{\frac{1}{RS}t_s}y[n - 1]$
$y[n] = \frac{1}{RC}x[n] + e^{\frac{1}{RS}t_s}y[n - 1]$

### Example2: In case that H(s) is given
$H_c(s) = \frac{17410.145}{ğ‘ ^2 + 137.945365ğ‘  + 17410.145}$
#### 3. inverse LT
$H_c(s) = \frac{17410.145}{ğ‘ ^2 + 137.945365ğ‘  + 17410.145} = c\frac{b}{(s + a)^2 + b^2}$
$h_c(t) = ce^{-at}sin(bt),\space\space a= -68.97, b = 112.485173, c= 154.77724$

#### 4. sampling - $f_s = 100Hz(t_s = 0.01 sec)$
$h_d[n] = h_c(t)|_{t = 0.01n} = ce^{-0.01an}sin(0.01bn)$

#### 5. ZT
$sin(0.01bn) = \frac{e^{j0.01bn} - e^{- j0.01bn}}{2j}$
$h_d[n] = h_c(t)|_{t = 0.01n} = ce^{-0.01an}sin(0.01bn)= ce^{-0.01an} \frac{e^{j0.01bn} - e^{- j0.01bn}}{2j} $
$h_d[n] = c(\frac{e^{-0.01an + j0.01bn}}{2j} - \frac{e^{-0.01an- j0.01bn}}{2j}) = c(\frac{e^{(-0.01a + j0.01b)n}}{2j} - \frac{e^{(-0.01a- j0.01b)n}}{2j})$
$H(z) = \frac{70.059517ğ‘§^{-1}}{1 - 0.43278805ğ‘§^{-1} + 0.25171605ğ‘§^{-2}}$
<br/>

$ğ‘¦[ğ‘›] = 0.01(70.059517ğ‘¥[n - 1]) + 0.43278805ğ‘¦[ğ‘› âˆ’ 1] - 0.25171605ğ‘¦(ğ‘› âˆ’ 2)$

### Problems of impulse invariance method
- ìƒ˜í”Œë§ ì´ë¡ ì„ ë”°ë¥´ì§€ ì•ŠìŒ -> ë”°ë¼ì„œ ì£¼íŒŒìˆ˜ì˜ ì œí•œì´ ì—†ì–´ aliasing í˜„ìƒì´ ì¼ì–´ë‚œë‹¤.

## 3. Bilinear Transform Method
- impulse invariance methodì˜ ê²½ìš°, ìƒ˜í”Œë§í• ë•Œ ìƒ˜í”Œë§ ì´ë¡ ì„ ê³ ë ¤í•˜ì§€ ì•ŠëŠ”ë‹¤. -> aliasing í˜„ìƒì´ ë°œìƒí•˜ëŠ” ì›ì¸!
- ë”°ë¼ì„œ í•´ë‹¹ ë¶€ë¶„ì„ ê³ ì³ì•¼í•œë‹¤.
- impulse invariance method
  1. Take an analog filter 
  2. Apply the Laplace Tranform to obtain H(s)
  3. Apply inverse LT ot obtain h(t)
  4. Sampling h(t) at a given sampling rate <- **delete!**
  5. Apply the z-transform to obtain H(z)
  6. Apply inverse ZT to obtain the difference equation with x(n) and y(n)

### Convert H(s) to H(z)
- sì™€ zëŠ” ëª¨ë‘ ì£¼íŒŒìˆ˜ê³„ì— ì¡´ì¬í•˜ëŠ” ë³€ìˆ˜ì´ë‹¤. -> ì„œë¡œ í˜¸í™˜ ê°€ëŠ¥í•¨.

$F(s) = \int _0 ^{\infin}f(t) e^{-st}dt \simeq \Sigma _{n = 0}^{\infin} f(nt_s)e^{-snt_s}$
$F(z) = \Sigma _{n = 0}^{\infin} f(n) z^{-n}$
$z = Ae^{j\Phi}, \Phi = st_s$
- ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‹ì„ í’€ì–´ë‚˜ê°€ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê²°ë¡ ì´ ë„ì¶œë¨
$s = \frac{2}{T}\frac{1 - z^{-1}}{1 + z^{-1}}$


### Example1: RC-low pass filter
#### 4. change H(s) to H(z)
$s = \frac{2}{T}\frac{1 - z^{-1}}{1 + z^{-1}}$
$H(s) = \frac{1}{RCs + 1}$
<br/>

$H(z) = \frac{1}{RC\frac{2}{T}\frac{1 - z^{-1}}{1 + z^{-1}} + 1} = \frac{1 + z^{-1}}{(1 + \frac{2RC}{T}) +(1 - \frac{2RC}{T})z^{-1}}$